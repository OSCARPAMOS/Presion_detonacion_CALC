<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

 
    
</head>

<body>
    <main>
    
     <div class="container mb-5">
    
    <!-- Header -->
    
     <header class="d-flex flex-wrap py-3 mb-5 border-bottom">
    
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
     <div class="container">
      <a class="navbar-brand" href="#">PRESIÓN DE DETONACIÓN</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
       <span class="navbar-toggler-icon"></span>
      </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
    
             <li class="nav-item">
               <a class="nav-link active" aria-current="page" href="#">Home</a>
             </li>
    
             <li class="nav-item">
             <a class="nav-link" aria-current="page" href="nosotros.html">Nosotros</a>
             </li>
    
             <li class="nav-item">
              <a class="nav-link" aria-current="page" href="#">Servicios</a>
             </li>
    
             <li class="nav-item">
              <a class="nav-link" aria-current="page" href="#">Contacto</a>
             </li>
    
            </ul>
           </div>
    
           <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
           </form>
    
          </div>
    
    
         </nav>
    
        </header>
    
    
    
       </div>
    
       <!-- Contenido generel BODY 1 -->
    
       <div class="container">
        <br>
        <h1> Cálculo de la Pressión de Detonación a distancia variable <br> (por tipo de explosivo) </h1> 
        <br>
       </div>
       
       <!-- Selección de tipo de explosivo -->

       <div class="container">
        <h4> Introduce el tipo y cantidad de explosivo :</h4>
        
        <select id="exsel" class="form-select" multiple aria-label="Ejemplo de multiple select">
            <option selected> Escoje el Explosivo</option>
            <option value="1"> TNT </option>
            <option value="2"> RDX </option>
            <option value="3"> HMX </option>
            <option value="3"> PNTR </option>
            <option value="3"> SEMTEX 100 </option>
        </select>
      </div>
      <div class="container"> <br>
       <label for="basic-url" class="form-label">Cantidad de Explosivo en gramos : </label>
       <div input-group mb-3">
         <span class="input-group-text" id="basic-addon3"> GRAMOS (g) </span>
         <input type="text" class="form-control" id="cantidad" aria-describedby="basic-addon3">
       </div>
    </div>
    
        
    <!-- Rangos de distancia -->
    <div class="container"> <br>
      
      
      <label for="customRange1" class="form-label"> Desliza para cambiar la distancia :  </label>

      <span id="myValue"></span>

      <input id="myRange" type="range"  id="customRange1" min="1" max="100" value="50" step="0.1" style="width:80%"> <!-- class="form-range"-->
   
    </div>
<!-- Intento de mostrar los valores del rango -->
    <script type="text/javascript" charset="utf-8">
      var myRange = document.querySelector('#myRange');
      var myValue = document.querySelector('#myValue');
      var myUnits = ' (m) Metros';
      var off = myRange.offsetWidth / (parseInt(myRange.max) - parseInt(myRange.min));
      var px =  ((myRange.valueAsNumber - parseInt(myRange.min)) * off) - (myValue.offsetParent.offsetWidth / 2);
      
        myValue.parentElement.style.left = px + 'px';
        myValue.parentElement.style.top = myRange.offsetHeight + 'px';
        myValue.innerHTML = myRange.value + ' ' + myUnits;
      
        myRange.oninput =function(){
          let px = ((myRange.valueAsNumber - parseInt(myRange.min)) * off) - (myValue.offsetWidth / 2);
          myValue.innerHTML = myRange.value + ' ' + myUnits;
          myValue.parentElement.style.left = px + 'px';
        };
    </script>

<!-- Botón de ejecución del algoritmo -->
<br>
<div class="container">
  <button id="ejecutar" type="submit" class="btn btn-primary" >Ejecutar Simulacro</button>
</div>



    <!-- Salida datos en Pantalla (al cambiar el rango cambia el valor)-->

    <div  id="answers" class="container">
<br>
      <table class="table">
        <thead>
          <tr>
            <th id="fila1titulo" scope="col"></th>
            <th id="fila2titulo" scope="col"></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th scope="row"></th>
            <td></td>
           
          </tr>
          <tr>
            <th scope="row"></th>
            <td></td>
           
          </tr>
          <tr>
            <th scope="row"></th>
            <td></td>
          </tr>
        </tbody>
      </table>
      <!--  

      <table id="answerTable" class="table table-striped">
        <tr>
          <td style="width:40%;">Peso en TNT para presión (kg):</td>
          <td id="tntPressure" class="answer" style="width:10%;"></td>
          <td style="width:40%;">Peso en TNT para impulso (kg):</td>
          <td id="tntImpulse"  class="answer" style="width:10%;"></td>
        </tr>
        </table>

        -->
    </div>




<script>

    var ejecutar = document.getElementById("ejecutar");

    ejecutar.addEventListener("click", () => {
    
      var tipoexp = document.getElementById('exsel').options[document.getElementById('exsel').selectedIndex].text;
      var weight = document.getElementById('cantidad').value;
      var range = document.getElementById ('myRange').value;

      /* Los mismos datos del archivo JSON

         import explosiveData from './explosivedata.json'assert {type: "json"};
         var b = JSON.parse(JSON.stringify(explosiveData));
         console.log(b);

      */

      const explosivedata =[{
      "nombre": "TNT",
      "densidad" : "1.2", 
      "equivalentesTNT": "1"
    },
    {
      "nombre": "RDX",
      "densidad" : "1.4", 
      "equivalentesTNT": "1.3"
    },
    {
        "nombre": "Amonal",
        "densidad" : "1.1", 
        "equivalentesTNT": "0.9"
    }
  ];

  var densidadf = 0;
  var equivTNTf = 0;

    for (let i=0; i <= explosivedata.length; i++){


      if (explosivedata[i].nombre == tipoexp) {
        densidadf = Number(explosivedata[i].densidad);
        equivTNTf = Number(explosivedata[i].equivalentesTNT);
       
        break
      
      } /*else{
        alert ("Datos no encontrados, elija un explosivo")
        break
      }*/

    };

    
      console.log( "Explosivo seleccionado : " + tipoexp);
      console.log( "Datos explosivo seleccionado: densidad" + densidadf +" equivalentes TNT: "+ equivTNTf);
      console.log( "Distancia :  " + range);
      console.log( "Peso : " + weight );
     
      var t = Math.pow((equivTNTf*range)/weight,0.3333333) ;
      var t2 = Math.log(t)/Math.log(10);

      calculateIncidentPressure(t2);
      calculateTimeOfArrival(t2);
      calculateShockFrontVelocity (t2);
      console.log (t, t2);

      // Presión Máxima 
function calculateIncidentPressure(t){ //NATO AASTP version
    U = -0.214362789151 + 1.35034249993 * t;
    ip = 2.78076916577 - 1.6958988741 * U -
        0.154159376846 * Math.pow(U,2) +
        0.514060730593 * Math.pow(U,3) +
        0.0988534365274 * Math.pow(U,4) -
        0.293912623038 * Math.pow(U,5) -
        0.0268112345019 * Math.pow(U,6) +
        0.109097496421 * Math.pow(U,7) +
        0.00162846756311 * Math.pow(U,8) -
        0.0214631030242 * Math.pow(U,9) +
        0.0001456723382 * Math.pow(U,10) +
        0.00167847752266 * Math.pow(U,11);
    ip = Math.pow(10,ip);
    ip = ip.toFixed(3);
    return ip;
};


// Tiempo para llegada Onda de choque
function calculateTimeOfArrival(t) {
    cubeRootOfChargeWeight = Math.pow((equivTNTf*range)/weight,0.3333333);
    U = -0.202425716178 + 1.37784223635 * t;
    toa = -0.0591634288046 + 1.35706496258 * U +
        0.052492798645 * Math.pow(U,2) -
        0.196563954086 * Math.pow(U,3) -
        0.0601770052288 * Math.pow(U,4) +
        0.0696360270891 * Math.pow(U,5) +
        0.0215297490092 * Math.pow(U,6) -
        0.0161658930785 * Math.pow(U,7) -
        0.00232531970294 * Math.pow(U,8) +
        0.00147752067524 * Math.pow(U,9);
    toa = Math.pow(10,toa);
    toa = toa * cubeRootOfChargeWeight;
    toa = toa.toFixed(3);
    return toa;
}

//Velocidad de la Onda expansiva

function calculateShockFrontVelocity(t) {
    U = -0.202425716178 + 1.37784223635 * t;
    sv = -0.06621072854 - 0.698029762594 * U +
        0.158916781906 * Math.pow(U,2) +
        0.443812098136 * Math.pow(U,3) -
        0.113402023921 * Math.pow(U,4) -
        0.369887075049 * Math.pow(U,5) +
        0.129230567449 * Math.pow(U,6) +
        0.19857981197 * Math.pow(U,7) -
        0.0867636217397 * Math.pow(U,8) -
        0.0620391900135 * Math.pow(U,9) +
        0.0307482926566 * Math.pow(U,10) +
        0.0102657234407 * Math.pow(U,11) -
        0.00546533250772 * Math.pow(U,12) -
        0.000693180974 * Math.pow(U,13) +
        0.0003847494916 * Math.pow(U,14);
    sv = Math.pow(10,sv) * 1000;
    sv = sv.toFixed(3);
    return sv;
}
  
console.log ("presion incidente: " + ip);
console.log ("Tiempo de llegada: " + toa);
console.log ("Velocidad de la Onda de choque : " + sv);

var escribir =document.getElementById("fila1titulo");
escribir.innerHTML = "Presión máxima kPa : " ;

var escribir2= document.getElementById("fila2titulo");
escribir2.innerHTML = sv;



/*
let div = document.createElement('div');
div.id = 'content';
div.className = 'container';
div.innerHTML = '<br><p>CreateElement example</p>';
document.getElementById("answers").appendChild(div);


*/


      
    });
    

</script>



<!-- Final de la salida de los datos-->


    <br><br><br><br><br>
       <!-- newsletter -->
       <div class="container mb-5">
        <div class="row">
         <div class="row row-cols-1 text-center mt-5 mb-3">
          <h2>Newsletter</h2>
         </div>
         <div class="row">
          <form action="" method="">
           <div class="row justify-content-center">
            <div class="col-lg-6">
             <div class="input-group">
              <input type="email" class="form-control" id="email" name="email" placeholder="micorreo@mail.com" required>
              <span class="input-group-btn">
               <button class="btn btn-primary" type="submit">Aceptar</button>
              </span>
             </div>
            </div>
           </div>
          </form>
         </div>
        </div>
       </div>
    
    
      </main>
    
      <!-- Footer -->
      <footer class="footer mt-auto py-3 bg-dark">
       <div class="container">
        <span class="text-white"> Oscar Pamos © <script>
          document.write(new Date().getFullYear())
    
         </script> </span>
       </div>
      </footer>
    
    
    
     </body>
    
</html>